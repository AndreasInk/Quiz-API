# -*- coding: utf-8 -*-


#!pip install  -U transformers==3.0.0

#!python -m  nltk.downloader punkt

# !git clone https://github.com/patil-suraj/question_generation.git



text = "In the last section, we examined some early aspects of memory. In this section, what we’re going to do is discuss some factors that influence memory. So let’s do that by beginning with the concept on slide two, and that concept is overlearning. Basically in overlearning, the idea is that you continue to study something after you can recall it perfectly. So you study some particular topic whatever that topic is. When you can recall it perfectly, you continue to study it. This is a classic way to help when one is taking comprehensive finals later in the semester. So when you study for exam one and after you really know it all, you continue to study it. That will make your comprehensive final easier. The next factor that will influence memory relates to what we call organization. In general, if you can organize material, you can recall it better. There are lots of different types of organizational strategies and I’ve listed those on slide four. So let’s begin by talking about the first organizational strategy called clustering and is located on page five. In clustering, basically you recall items better if you can recognize that there are two or more types of things in a particular list. So let’s give a couple of lists and show you some examples of that. These examples are shown in slide six. Let’s say that I give you the first list; north, cardinal, south, robin, east, wren, west, sparrow. Now if you can recognize that north, south, east and west are points on a compass and cardinal, robin, wren and sparrow are birds, then you have a higher probability of recalling that material than if you just tried to recall the list in order. The same occurs with the second list that is located on the right hand side of page six. So let’s list these words as well; pig, cat, horse, dog, sheep, birds, cow, and fish. Now if you can recognize that these are two groups of animals; one being farm animals and the other being domestic companions, ala, pets, then you can recall that list of material better than if you just tried to recall the list in order. So again, this is another type of example of organizational strategy. Now there are other organizational strategies that one can use as well. The next one of these, as we see on slide seven, are what are called verbal pneumonic techniques. In verbal pneumonic techniques, you make your own organization and there are many, many different types of techniques. So let’s talk about the first of these on slide eight and that is called acrostics. In acrostics these are phrases in which the first letter of each word functions as a cue to help you recall some piece of information. There are a variety of different acrostics that one uses. The most famous of these relates to this saying: On Old Olympus Towering Tops A Fin And German Vented Some Hops. These relate to the twelve different cranial nerves that we have within the brain and if you are a traditional medical student or taking anatomy and physiology, this is the acrostic that you usually use to remember them. Now there are other verbal pneumonic techniques as well. So let’s take a look at another one of those and is located in slide 10. These are called acronyms. Acronyms are basically a word formed out of the first letters of a series of words. A classic example of an acronym system is ROY G BIV which are the first letters of the colors in the visual spectrum. This is the classic acronym that all sensation and perception students and even introductory psych students learn to memorize. Another verbal pneumonic technique is shown on slide 11 and called Rhymes. The classic rhyme is one that you had learned in grade school is I before E except after C. So rhymes are another way to recall and memorize information. So now we’ve examined a variety of different verbal pneumonic techniques and how they work. In this next section, we’re going to examine some visual imagery types of methods to organize material. The first of these is shown in slide 13 and is called the Method of Loci. Basically it involves taking some kind of an imaginary walk along some familiar path where images that you’re trying to recall are associated with some items or locations along the path. The classic example of where we put material is in your house. So just close your eyes and think about this. What happens when you walk in your back door? What’s the first item that you see. Well the first item that you see is where you put the first piece of information that you want to remember. Let’s say that it is a coat hook, so you hang something on the coat hook. Then you continue on into the kitchen. In the kitchen, what’s the first thing that you see? Well it may be the refrigerator, and so you identify the second item that you’re trying to remember and put it on the refrigerator. Then you open the door in the refrigerator and that’s where you put your third item. And then you close the refrigerator door and you look to your left and there’s the stove. So, you put the next item on one of the burners of the stove and on and on until you have all the items that you are trying to remember located within the kitchen or within the house. Then when you’re trying to recall the items during the exam, you begin your walk around the house. So the first thing you think about is what happens when I walk in the back door and lo and behold, there’s the first item I’m trying to recall. Then I go to the refrigerator and there’s the second item. Then I open the door of the refrigerator and there’s the third item and on and on until I have all the different materials that I’m trying to remember put down for my exam. Now walking around the house is a good place to use the method of loci, but there are other places that’s even better. The better place to try and place all the information you want to learn is in the location where you’re going to have to recall the material. So sitting in the exam room where you’re going to take the test and putting all those things on different objects within the exam room is a good strategy. Especially if one is trying to memorize lots and lots of different information because each of those places acts as a cue. So that’s the first type of visual imagery technique. Now the second type of visual imagery technique is shown on slide 14. This is called the pegword technique. The pegword technique relies on a list of integers. What you do is attach a pegword to each of the numbers with rhymes. The classic example is One rhyming with Bun, Two and Shoe, Three and Tree, Four and Door and on and on. Then as we see in slide 15, when you’re given a list of words to recall, you associate the first word in the list with the peg word. For example you have a word, let’s say you’re trying to recall the word “Bee” and the peg word is bun. Well what you might try to do is visualize a bee eating a great big bun. As a result of that, you make associations. Furthermore, the more outrageous the association, the better the recall is for the particular item. So, let’s say that you might have a frog with shoes on, and a horse knocking down a tree, or whatever it may be to the information that you’re trying to recall. So these are the first two techniques (overlearning, organization) that relate to factors that influence memory. What’s the next major factor? Well, the next major factor is shown on slides 16 and 17 and that is the order in which you learn things. If I give you a list of words in a serial learning task or a free recall task, you have better recall for words at the beginning and end of a list but not in the middle of a particular list. That is called the Serial Position Effect. There’s a couple different things you need to note about the serial position effect. First recall at the beginning of the list is what is called the Primacy Effect and recall for the end of the list is called the Recency Effect. The recency effect occurs because you can generally only recall seven plus or minus two items in working or what is also called short term memory. We’ll talk about that in more detail a little bit later. Now the serial position effect is shown in the graphical figure on slide 19. As we can see when we start to memorize a list of words, we usually start about 60 to 65% accuracy. In the recency phase, at the last word that we’re trying to recall we have a percent recall rate of about 85 to 90% depending on the study. Note within the middle of the list that you’re trying to look at you only have about a 20% chance of recalling a particular set of items. So the serial recall effect is extremely important for how you try to memorize things. For example, if you were studying three chapters for learning, as what we might have here, and you always start with the first chapter in order (so you start with chapter one, then two, then three), you will have fairly good recall for chapter one, you’ll have some decent recall also for chapter three but chapter two you won’t remember at all. So a better way to memorize that material is to change the order in which you’re learning the material. So you start one day with chapters one, two, and three in that order, then you go with two, three, and one; and finally, three, one and two, and on and on. What this does is help you raise the level of the middle section within the recency of effect. So, within the serial learning effect, what you should do is vary the order so you have good recall of information. Now there’s another variable that goes along with the serial position effect and is shown on slide 20. It is called the Von Resterhoff Effect. Basically when a word is in the middle of a list that is surprising or funny or dirty, you will usually recall that particular word and some of those around it. So let’s give an example of that in the following slide."

text2 = "Gravity (from Latin gravitas, meaning 'weight'), or gravitation, is a natural phenomenon by which all \
things with mass or energy—including planets, stars, galaxies, and even light—are brought toward (or gravitate toward) \
one another. On Earth, gravity gives weight to physical objects, and the Moon's gravity causes the ocean tides. \
The gravitational attraction of the original gaseous matter present in the Universe caused it to begin coalescing \
and forming stars and caused the stars to group together into galaxies, so gravity is responsible for many of \
the large-scale structures in the Universe. Gravity has an infinite range, although its effects become increasingly \
weaker as objects get further away"

text3 = "42 is the answer to life, universe and everything."

text4 = "Forrest Gump is a 1994 American comedy-drama film directed by Robert Zemeckis and written by Eric Roth. \
It is based on the 1986 novel of the same name by Winston Groom and stars Tom Hanks, Robin Wright, Gary Sinise, \
Mykelti Williamson and Sally Field. The story depicts several decades in the life of Forrest Gump (Hanks), \
a slow-witted but kind-hearted man from Alabama who witnesses and unwittingly influences several defining \
historical events in the 20th century United States. The film differs substantially from the novel."

text5 = "What is the true nature of the universe? \
To answer this question, \
humans come up with stories to describe the world. \
We test our stories and learn what to keep and what to throw away.\
But the more we learn, \
the more complicated and weird our stories become. \
Some of them so much so, \
that it is really hard to know what they are actually about. \
Like string theory. \
A famous, controversial and often misunderstood story, \
about the nature of everything. \
Why did we come up with it and is it correct? \
Or just an idea we should chuck out? \
To understand the true nature of reality, \
we looked at things up close and were amazed. \
Wonderous landscapes in the dust, \
zoos of bizarre creatures, \
complex protein robots. \
All of them made from structures of molecules \
made up of countless even smaller things: \
Atoms. \
We thought they were the final layer of reality, \
until we smashed them together really hard \
and discovered things that can't be divided anymore: \
Elementary particles. \
But now, we had a problem: \
They are so small that we could no longer look at them. \
Think about it: what is seeing? \
To see something, we need light, an electromagnetic wave. \
This wave hits the surface of the thing \
and gets reflected back from it into your eye. \
The wave carries information from the object \
that your brain uses to create an image. \
So you cannot see something without somehow interacting with it. \
Seeing is touching, an active process, not a passive one. \
This is not a problem with most things. \
But particles are very small. \
So small that the electromagnetic waves we used to see \
are too big to touch them."

text6 = "Python is the world's fastest growing and most popular programming language, not just \
amongst software engineers, but also amongst mathematicians, \
data analysts, scientists, accountants, networking engineers, \
and even kids! Because it's a very beginner friendly programming \
language. So people from different disciplines use Python \
for a variety of different tasks, such as data analysis and visualization, \
artificial intelligence and machine learning, automation."

text7 = "Sigmund Freud is known as the founder of psychoanalysis, a field of psychology that has been deemed by many as dead or dying. One thing that has kept it alive is the emphasis Freud put on his study of memory. Freud was fascinated with memory and all the ways it could be understood, used, and manipulated. Some claim that his studies have been quite influential in contemporary memory research, including the research into the field of false memory.[3] Pierre Janet was a French Neurologist also credited with great contributions into memory research. Pierre contributed to false memory through his ideas on dissociation and memory retrieval through hypnosis."

"""## Single task QA"""

# Commented out IPython magic to ensure Python compatibility.
# %cd question_generation

from pipelines import pipeline

nlp = pipeline("question-generation")

nlp(text)

"""If you want to use the t5-base model, then pass the path through model parameter"""

nlp = pipeline("question-generation", model="valhalla/t5-base-qg-hl")

nlp(text)

nlp(text4)

nlp(text)



"""## Multitask QA-QG

### small-model
"""

nlp = pipeline("multitask-qa-qg")

"""#### QG"""

nlp(text)

nlp(text2)

nlp(text4)



"""#### QA"""

nlp({
  "question": "Who created Python ?",
  "context": text
})

nlp({
    "question": "Who wrote Forrest Gump ?",
     "context": text4
})



"""### base-model"""

nlp = pipeline("multitask-qa-qg", model="valhalla/t5-base-qa-qg-hl")



"""#### QG"""

nlp(text)

nlp(text2)

nlp(text4)



"""#### QA"""

nlp({
  "question": "Who created Python ?",
  "context": text
})

nlp({
    "question": "Who wrote Forrest Gump ?",
     "context": text4
})



"""## End-to-End QG

### small model
"""

nlp = pipeline("e2e-qg")

nlp(text)

nlp(text2)

nlp(text4)



"""### base-model"""

nlp = pipeline("e2e-qg", model="valhalla/t5-base-e2e-qg")

nlp(text)

nlp(text2)

nlp(text4)

#!pip install flask-ngrok

from flask_ngrok import run_with_ngrok
from flask import Flask, request, Response
import json


app = Flask(__name__)
run_with_ngrok(app)   #starts ngrok when the app is run

@app.route("/quizify", methods=['POST'])
def quizify():
  res = request.get_json()
  print (res)

  textin = res['text']

  quiz = nlp(textin)

  status = {}
  status['request'] = res
  status['quiz'] = quiz

  statusjson = json.dumps(status)

  resp = Response(statusjson, status=200, mimetype='application/json')

  return resp



@app.route("/")
def home():
    return "<h1>Running Flask on Google Colab!</h1>"
  
app.run()